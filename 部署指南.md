# 文化数字档案 DApp 部署指南

## 🚀 快速部署方案

### 方案1: Vercel部署（推荐）

#### 步骤1: 准备项目
```bash
# 确保项目可以正常构建
npm run build
```

#### 步骤2: 安装Vercel CLI
```bash
npm install -g vercel
```

#### 步骤3: 部署
```bash
# 在项目根目录执行
vercel

# 按提示操作：
# 1. 登录Vercel账户
# 2. 选择项目设置
# 3. 确认部署
```

#### 步骤4: 配置环境变量
在Vercel控制台中设置：
- `NEXT_PUBLIC_CONTRACT_ADDRESS` - 智能合约地址
- `NEXT_PUBLIC_INFURA_PROJECT_ID` - Infura项目ID

### 方案2: Netlify部署

#### 步骤1: 构建项目
```bash
npm run build
```

#### 步骤2: 上传到Netlify
1. 访问 [netlify.com](https://netlify.com)
2. 注册/登录账户
3. 拖拽 `out` 文件夹到部署区域
4. 配置环境变量

### 方案3: 传统服务器部署

#### 步骤1: 构建生产版本
```bash
npm run build
```

#### 步骤2: 启动生产服务器
```bash
npm start
```

#### 步骤3: 配置反向代理（Nginx示例）
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## 🌐 域名和HTTPS配置

### 1. 域名配置
- 购买域名（如阿里云、腾讯云）
- 配置DNS解析到部署服务器
- 在部署平台配置自定义域名

### 2. HTTPS配置
- Vercel/Netlify自动提供HTTPS
- 传统服务器需要配置SSL证书
- 推荐使用Let's Encrypt免费证书

## 🔧 环境变量配置

### 生产环境变量
```env
# 智能合约地址
NEXT_PUBLIC_CONTRACT_ADDRESS=0x...

# IPFS配置
NEXT_PUBLIC_INFURA_PROJECT_ID=your-project-id

# 其他配置
NEXT_PUBLIC_APP_URL=https://your-domain.com
```

## 📱 移动端适配

### 1. PWA配置
```json
// next.config.js
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
})

module.exports = withPWA({
  // 其他配置
})
```

### 2. 响应式设计
- 已使用Tailwind CSS响应式类
- 支持移动端访问
- 触摸友好的交互设计

## 🔒 安全考虑

### 1. 环境变量安全
- 不要在前端暴露敏感信息
- 使用环境变量管理配置
- 定期轮换API密钥

### 2. 智能合约安全
- 部署前进行安全审计
- 使用多签名钱包管理
- 定期更新合约

## 📊 监控和分析

### 1. 性能监控
- 使用Vercel Analytics
- 配置错误监控
- 性能指标跟踪

### 2. 用户分析
- Google Analytics集成
- 用户行为分析
- 转化率跟踪

## 🔄 持续部署

### 1. GitHub Actions
```yaml
name: Deploy to Vercel
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
```

### 2. 自动测试
```bash
# 运行测试
npm test

# 代码质量检查
npm run lint
```

## 📞 技术支持

### 常见问题
1. **构建失败**: 检查依赖和配置
2. **环境变量**: 确保正确设置
3. **域名解析**: 检查DNS配置
4. **HTTPS问题**: 确认证书配置

### 联系支持
- 项目Issues: GitHub Issues
- 文档: README.md
- 社区: 相关技术论坛

## 🎯 部署检查清单

- [ ] 项目可以正常构建
- [ ] 环境变量配置完成
- [ ] 域名解析正确
- [ ] HTTPS证书有效
- [ ] 移动端测试通过
- [ ] 性能优化完成
- [ ] 监控配置完成
- [ ] 备份策略制定

## 🚀 上线后维护

### 1. 定期更新
- 依赖包更新
- 安全补丁应用
- 功能迭代发布

### 2. 性能优化
- 代码分割优化
- 图片压缩处理
- CDN加速配置

### 3. 用户支持
- 问题反馈收集
- 功能需求调研
- 用户培训文档 